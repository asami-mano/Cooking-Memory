{% extends 'base.html' %}
{% block content %}

{% for record in records %}
  <div class="record">
    {% if record.image_url %}
        <img src="{{ record.image_url.url }}" alt="料理写真" />
    {% else %}
        <p>画像なし</p>
        {% comment %} <img src="{% static 'images/no_image.png' %}" alt="画像なし" /> {% endcomment %}
    {% endif %}

    <button class="favorite-btn" onclick="toggleFavorite({{ record.id }}, this)">
      {% if record.is_favorite %}
        ❤️
      {% else %}
        🤍
      {% endif %}
    </button>
  </div>
{% endfor %}

<script>
function toggleFavorite(recordId, btn) {
  fetch(`/cooking_records/${recordId}/toggle_favorite/`, {
    method: 'POST',
    headers: {
      'X-CSRFToken': '{{ csrf_token }}',
      'Content-Type': 'application/json'
    },
  })
  .then(res => res.json())
  .then(data => {
    if (data.is_favorite) {
      btn.textContent = '❤️';
    } else {
      btn.textContent = '🤍';
    }
  });
}
</script>


{% endblock  %}